<pre>
otoml version 970e114
<b>FAIL</b> <b>valid/array/open-parent-table</b>
<b> </b>    Array lengths differ for key "parent-table.arr":
<b> </b>      Expected:     2
<b> </b>      Your encoder: 1

<b>     input sent to parser-cmd (PID 3223):</b>
       [[parent-table.arr]]
       [[parent-table.arr]]
       [parent-table]
       not-arr = 1

<b>     output from parser-cmd (PID 3223) (stdout):</b>
       {
         "parent-table": {
           "arr":     [{}],
           "not-arr": {"type": "integer", "value": "1"}
         }
       }

<b>     want:</b>
       {
           "parent-table": {
               "not-arr": {"type": "integer", "value": "1"},
               "arr": [
                   {},
                   {}
               ]
           }
       }

<b>FAIL</b> <b>valid/key/like-date</b>
<b> </b>    Syntax error on line 2, character 1: Unexpected ']'
<b> </b>    Exit 1

<b>     input sent to parser-cmd (PID 3315):</b>
       # '-' is a valid character in keys: make a key that looks like a date.
       2001-02-03   = 1
       "2001-02-04" = 2
       '2001-02-05' = 3

       # Also include datetime and time for good measure; these need to be quoted as
       # ':' isn't a valid bare key.
       "2001-02-06T15:16:17+01:00" = 4
       "2001-02-07T15:16:17"       = 5
       "15:16:17"                  = 6

       # Dotted keys
       a.2001-02-08 = 7
       a.2001-02-09.2001-02-10 = 8
       2001-02-11.a.2001-02-12 = 9

       # Table names
       [2002-01-02]
       k = 10

       [2002-01-02.2024-01-03]
       k = 11

       [[2002-01-04]]
       k = 12

<b>     output from parser-cmd (PID 3315) (stderr):</b>
       Syntax error on line 2, character 1: Unexpected ']'
       Exit 1

<b>     want:</b>
          <empty>

<b>FAIL</b> <b>valid/key/numeric-06</b>
<b> </b>    Syntax error on line 1, character 1: "-1" is not a valid key
<b> </b>    Exit 1

<b>     input sent to parser-cmd (PID 3320):</b>
       -1    = true

<b>     output from parser-cmd (PID 3320) (stderr):</b>
       Syntax error on line 1, character 1: "-1" is not a valid key
       Exit 1

<b>     want:</b>
          <empty>

<b>FAIL</b> <b>valid/table/array-empty</b>
<b> </b>    Array lengths differ for key "a":
<b> </b>      Expected:     1
<b> </b>      Your encoder: 0

<b>     input sent to parser-cmd (PID 3408):</b>
       [[a]]

<b>     output from parser-cmd (PID 3408) (stdout):</b>
       {
         "a": []
       }

<b>     want:</b>
       {
           "a": [{}]
       }

<b>FAIL</b> <b>invalid/array/extend-defined-aot</b>
<b> </b>    Expected an error, but no error was reported.

<b>     input sent to parser-cmd (PID 3437):</b>
       [[tab.arr]]
       [tab]
       arr.val1=1

<b>     output from parser-cmd (PID 3437) (stdout):</b>
       {
         "tab": {"arr": [{
           "val1": {"type": "integer", "value": "1"}
         }]}
       }

<b>     want:</b>
       Exit code 1

<b>FAIL</b> <b>invalid/array/extending-table</b>
<b> </b>    exit status 2

<b>     input sent to parser-cmd (PID 3439):</b>
       a = [{ b = 1 }]

       # Cannot extend tables within static arrays
       # https://github.com/toml-lang/toml/issues/908
       [a.c]
       foo = 1

<b>     output from parser-cmd (PID 3439) (stderr):</b>
       Fatal error: exception Otoml__Common.Duplicate_key("duplicate key \"a\" overrides a value of type array with a value of type table")

<b>     want:</b>
       Exit code 1

<b>FAIL</b> <b>invalid/array/tables-01</b>
<b> </b>    exit status 2

<b>     input sent to parser-cmd (PID 3470):</b>
       # INVALID TOML DOC
       fruit = []

       [[fruit]] # Not allowed

<b>     output from parser-cmd (PID 3470) (stderr):</b>
       Fatal error: exception Otoml__Common.Duplicate_key("table [fruit] is duplicated by an array of tables [[fruit]]")

<b>     want:</b>
       Exit code 1

<b>FAIL</b> <b>invalid/array/tables-02</b>
<b> </b>    exit status 2

<b>     input sent to parser-cmd (PID 3471):</b>
       # INVALID TOML DOC
       [[fruit]]
         name = "apple"

         [[fruit.variety]]
           name = "red delicious"

         # This table conflicts with the previous table
         [fruit.variety]
           name = "granny smith"

<b>     output from parser-cmd (PID 3471) (stderr):</b>
       Fatal error: exception Otoml__Common.Duplicate_key("array of tables [[fruit.variety]] is duplicated by a table [fruit.variety]")

<b>     want:</b>
       Exit code 1

<b>FAIL</b> <b>invalid/control/multi-cr</b>
<b> </b>    Expected an error, but no error was reported.

<b>     input sent to parser-cmd (PID 3500):</b>
       multi-cr   = """null"""

<b>     output from parser-cmd (PID 3500) (stdout):</b>
       {
         "multi-cr": {"type": "string", "value": "null\r"}
       }

<b>     want:</b>
       Exit code 1

<b>FAIL</b> <b>invalid/control/rawmulti-cr</b>
<b> </b>    Expected an error, but no error was reported.

<b>     input sent to parser-cmd (PID 3507):</b>
       rawmulti-cr   = '''null'''

<b>     output from parser-cmd (PID 3507) (stdout):</b>
       {
         "rawmulti-cr": {"type": "string", "value": "null\r"}
       }

<b>     want:</b>
       Exit code 1

<b>FAIL</b> <b>invalid/datetime/feb-29</b>
<b> </b>    Expected an error, but no error was reported.

<b>     input sent to parser-cmd (PID 3525):</b>
       "not a leap year" = 2100-02-29T15:15:15Z

<b>     output from parser-cmd (PID 3525) (stdout):</b>
       {
         "not a leap year": {"type": "datetime", "value": "2100-02-29T15:15:15Z"}
       }

<b>     want:</b>
       Exit code 1

<b>FAIL</b> <b>invalid/inline-table/duplicate-key-01</b>
<b> </b>    exit status 2

<b>     input sent to parser-cmd (PID 3641):</b>
       # Duplicate keys within an inline table are invalid
       a={b=1, b=2}

<b>     output from parser-cmd (PID 3641) (stderr):</b>
       Fatal error: exception Otoml__Common.Duplicate_key("duplicate key \"b\" overrides a value of type integer with a value of type integer")

<b>     want:</b>
       Exit code 1

<b>FAIL</b> <b>invalid/inline-table/duplicate-key-02</b>
<b> </b>    exit status 2

<b>     input sent to parser-cmd (PID 3644):</b>
       table1 = { table2.dupe = 1, table2.dupe = 2 }

<b>     output from parser-cmd (PID 3644) (stderr):</b>
       Fatal error: exception Otoml__Common.Duplicate_key("duplicate key \"dupe\" overrides a value of type integer with a value of type integer")

<b>     want:</b>
       Exit code 1

<b>FAIL</b> <b>invalid/inline-table/duplicate-key-03</b>
<b> </b>    Expected an error, but no error was reported.

<b>     input sent to parser-cmd (PID 3643):</b>
       tbl = { fruit = { apple.color = "red" }, fruit.apple.texture = { smooth = true } }

<b>     output from parser-cmd (PID 3643) (stdout):</b>
       {
         "tbl": {
           "fruit": {
             "apple": {
               "color": {"type": "string", "value": "red"},
               "texture": {
                 "smooth": {"type": "bool", "value": "true"}
               }
             }
           }
         }
       }

<b>     want:</b>
       Exit code 1

<b>FAIL</b> <b>invalid/inline-table/duplicate-key-04</b>
<b> </b>    exit status 2

<b>     input sent to parser-cmd (PID 3642):</b>
       tbl = { a.b = "a_b", a.b.c = "a_b_c" }

<b>     output from parser-cmd (PID 3642) (stderr):</b>
       Fatal error: exception Otoml__Common.Duplicate_key("duplicate key \"b\" overrides a value of type string with a value of type string")

<b>     want:</b>
       Exit code 1

<b>FAIL</b> <b>invalid/inline-table/overwrite-01</b>
<b> </b>    exit status 2

<b>     input sent to parser-cmd (PID 3656):</b>
       a.b=0
       # Since table "a" is already defined, it can't be replaced by an inline table.
       a={}

<b>     output from parser-cmd (PID 3656) (stderr):</b>
       Fatal error: exception Otoml__Common.Duplicate_key("duplicate key \"a\" overrides a value of type table with a value of type table")

<b>     want:</b>
       Exit code 1

<b>FAIL</b> <b>invalid/inline-table/overwrite-02</b>
<b> </b>    Expected an error, but no error was reported.

<b>     input sent to parser-cmd (PID 3657):</b>
       a={}
       # Inline tables are immutable and can't be extended
       [a.b]

<b>     output from parser-cmd (PID 3657) (stdout):</b>
       {
         "a": {
           "b": {}
         }
       }

<b>     want:</b>
       Exit code 1

<b>FAIL</b> <b>invalid/inline-table/overwrite-03</b>
<b> </b>    exit status 2

<b>     input sent to parser-cmd (PID 3658):</b>
       a = { b = 1 }
       a.b = 2

<b>     output from parser-cmd (PID 3658) (stderr):</b>
       Fatal error: exception Otoml__Common.Duplicate_key("duplicate key \"b\" overrides a value of type integer with a value of type integer")

<b>     want:</b>
       Exit code 1

<b>FAIL</b> <b>invalid/inline-table/overwrite-04</b>
<b> </b>    Expected an error, but no error was reported.

<b>     input sent to parser-cmd (PID 3659):</b>
       inline-t = { nest = {} }

       [[inline-t.nest]]

<b>     output from parser-cmd (PID 3659) (stdout):</b>
       {
         "inline-t": {
           "nest": {}
         }
       }

<b>     want:</b>
       Exit code 1

<b>FAIL</b> <b>invalid/inline-table/overwrite-05</b>
<b> </b>    Expected an error, but no error was reported.

<b>     input sent to parser-cmd (PID 3660):</b>
       inline-t = { nest = {} }

       [inline-t.nest]

<b>     output from parser-cmd (PID 3660) (stdout):</b>
       {
         "inline-t": {
           "nest": {}
         }
       }

<b>     want:</b>
       Exit code 1

<b>FAIL</b> <b>invalid/inline-table/overwrite-06</b>
<b> </b>    exit status 2

<b>     input sent to parser-cmd (PID 3661):</b>
       a = { b = 1, b.c = 2 }

<b>     output from parser-cmd (PID 3661) (stderr):</b>
       Fatal error: exception Otoml__Common.Duplicate_key("duplicate key \"b\" overrides a value of type integer with a value of type integer")

<b>     want:</b>
       Exit code 1

<b>FAIL</b> <b>invalid/inline-table/overwrite-07</b>
<b> </b>    exit status 2

<b>     input sent to parser-cmd (PID 3664):</b>
       tab = { inner.table = [{}], inner.table.val = "bad" }

<b>     output from parser-cmd (PID 3664) (stderr):</b>
       Fatal error: exception Otoml__Common.Duplicate_key("duplicate key \"table\" overrides a value of type array with a value of type string")

<b>     want:</b>
       Exit code 1

<b>FAIL</b> <b>invalid/inline-table/overwrite-08</b>
<b> </b>    Expected an error, but no error was reported.

<b>     input sent to parser-cmd (PID 3668):</b>
       tab = { inner = { dog = "best" }, inner.cat = "worst" }

<b>     output from parser-cmd (PID 3668) (stdout):</b>
       {
         "tab": {
           "inner": {
             "cat": {"type": "string", "value": "worst"},
             "dog": {"type": "string", "value": "best"}
           }
         }
       }

<b>     want:</b>
       Exit code 1

<b>FAIL</b> <b>invalid/inline-table/overwrite-09</b>
<b> </b>    exit status 2

<b>     input sent to parser-cmd (PID 3662):</b>
       [tab.nested]
       inline-t = { nest = {} }

       [tab]
       nested.inline-t.nest = 2

<b>     output from parser-cmd (PID 3662) (stderr):</b>
       Fatal error: exception Otoml__Common.Duplicate_key("duplicate key \"nest\" overrides a value of type table with a value of type integer")

<b>     want:</b>
       Exit code 1

<b>FAIL</b> <b>invalid/inline-table/overwrite-10</b>
<b> </b>    exit status 2

<b>     input sent to parser-cmd (PID 3670):</b>
       # Set implicit "b", overwrite "b" (illegal!) and then set another implicit.
       #
       # Caused panic: https://github.com/BurntSushi/toml/issues/403
       a = {b.a = 1, b = 2, b.c = 3}

<b>     output from parser-cmd (PID 3670) (stderr):</b>
       Fatal error: exception Otoml__Common.Duplicate_key("duplicate key \"b\" overrides a value of type table with a value of type integer")

<b>     want:</b>
       Exit code 1

<b>FAIL</b> <b>invalid/key/dotted-redefine-table-01</b>
<b> </b>    exit status 2

<b>     input sent to parser-cmd (PID 3720):</b>
       a = false
       a.b = true

<b>     output from parser-cmd (PID 3720) (stderr):</b>
       Fatal error: exception Otoml__Common.Duplicate_key("duplicate key \"a\" overrides a value of type boolean with a value of type boolean")

<b>     want:</b>
       Exit code 1

<b>FAIL</b> <b>invalid/key/dotted-redefine-table-02</b>
<b> </b>    exit status 2

<b>     input sent to parser-cmd (PID 3721):</b>
       # Defined a.b as int
       a.b = 1
       # Tries to access it as table: error
       a.b.c = 2

<b>     output from parser-cmd (PID 3721) (stderr):</b>
       Fatal error: exception Otoml__Common.Duplicate_key("duplicate key \"b\" overrides a value of type integer with a value of type integer")

<b>     want:</b>
       Exit code 1

<b>FAIL</b> <b>invalid/key/duplicate-keys-01</b>
<b> </b>    exit status 2

<b>     input sent to parser-cmd (PID 3727):</b>
       name = "Tom"
       name = "Pradyun"

<b>     output from parser-cmd (PID 3727) (stderr):</b>
       Fatal error: exception Otoml__Common.Duplicate_key("duplicate key \"name\" overrides a value of type string with a value of type string")

<b>     want:</b>
       Exit code 1

<b>FAIL</b> <b>invalid/key/duplicate-keys-02</b>
<b> </b>    exit status 2

<b>     input sent to parser-cmd (PID 3730):</b>
       dupe = false
       dupe = true

<b>     output from parser-cmd (PID 3730) (stderr):</b>
       Fatal error: exception Otoml__Common.Duplicate_key("duplicate key \"dupe\" overrides a value of type boolean with a value of type boolean")

<b>     want:</b>
       Exit code 1

<b>FAIL</b> <b>invalid/key/duplicate-keys-03</b>
<b> </b>    exit status 2

<b>     input sent to parser-cmd (PID 3725):</b>
       spelling   = "favorite"
       "spelling" = "favourite"

<b>     output from parser-cmd (PID 3725) (stderr):</b>
       Fatal error: exception Otoml__Common.Duplicate_key("duplicate key \"spelling\" overrides a value of type string with a value of type string")

<b>     want:</b>
       Exit code 1

<b>FAIL</b> <b>invalid/key/duplicate-keys-04</b>
<b> </b>    exit status 2

<b>     input sent to parser-cmd (PID 3728):</b>
       spelling   = "favorite"
       'spelling' = "favourite"

<b>     output from parser-cmd (PID 3728) (stderr):</b>
       Fatal error: exception Otoml__Common.Duplicate_key("duplicate key \"spelling\" overrides a value of type string with a value of type string")

<b>     want:</b>
       Exit code 1

<b>FAIL</b> <b>invalid/key/duplicate-keys-05</b>
<b> </b>    exit status 2

<b>     input sent to parser-cmd (PID 3722):</b>
       a        = 1
       "\u0061" = 1

<b>     output from parser-cmd (PID 3722) (stderr):</b>
       Fatal error: exception Otoml__Common.Duplicate_key("duplicate key \"a\" overrides a value of type integer with a value of type integer")

<b>     want:</b>
       Exit code 1

<b>FAIL</b> <b>invalid/key/duplicate-keys-06</b>
<b> </b>    exit status 2

<b>     input sent to parser-cmd (PID 3723):</b>
       "a'b"      = 1
       "a\u0027b" = 2

<b>     output from parser-cmd (PID 3723) (stderr):</b>
       Fatal error: exception Otoml__Common.Duplicate_key("duplicate key \"a'b\" overrides a value of type integer with a value of type integer")

<b>     want:</b>
       Exit code 1

<b>FAIL</b> <b>invalid/key/duplicate-keys-07</b>
<b> </b>    exit status 2

<b>     input sent to parser-cmd (PID 3724):</b>
       "" = 1
       "" = 2

<b>     output from parser-cmd (PID 3724) (stderr):</b>
       Fatal error: exception Otoml__Common.Duplicate_key("duplicate key \"\" overrides a value of type integer with a value of type integer")

<b>     want:</b>
       Exit code 1

<b>FAIL</b> <b>invalid/local-date/feb-29</b>
<b> </b>    Expected an error, but no error was reported.

<b>     input sent to parser-cmd (PID 3773):</b>
       "not a leap year" = 2100-02-29

<b>     output from parser-cmd (PID 3773) (stdout):</b>
       {
         "not a leap year": {"type": "date-local", "value": "2100-02-29"}
       }

<b>     want:</b>
       Exit code 1

<b>FAIL</b> <b>invalid/local-datetime/feb-29</b>
<b> </b>    Expected an error, but no error was reported.

<b>     input sent to parser-cmd (PID 3784):</b>
       "not a leap year" = 2100-02-29T15:15:15

<b>     output from parser-cmd (PID 3784) (stdout):</b>
       {
         "not a leap year": {"type": "datetime-local", "value": "2100-02-29T15:15:15"}
       }

<b>     want:</b>
       Exit code 1

<b>FAIL</b> <b>invalid/spec-1.0.0/inline-table-2-0</b>
<b> </b>    Expected an error, but no error was reported.

<b>     input sent to parser-cmd (PID 3807):</b>
       [product]
       type = { name = "Nail" }
       type.edible = false  # INVALID

<b>     output from parser-cmd (PID 3807) (stdout):</b>
       {
         "product": {
           "type": {
             "edible": {"type": "bool", "value": "false"},
             "name":   {"type": "string", "value": "Nail"}
           }
         }
       }

<b>     want:</b>
       Exit code 1

<b>FAIL</b> <b>invalid/spec-1.0.0/inline-table-3-0</b>
<b> </b>    exit status 2

<b>     input sent to parser-cmd (PID 3808):</b>
       [product]
       type.name = "Nail"
       type = { edible = false }  # INVALID

<b>     output from parser-cmd (PID 3808) (stderr):</b>
       Fatal error: exception Otoml__Common.Duplicate_key("duplicate key \"type\" overrides a value of type table with a value of type table")

<b>     want:</b>
       Exit code 1

<b>FAIL</b> <b>invalid/spec-1.0.0/table-9-0</b>
<b> </b>    Expected an error, but no error was reported.

<b>     input sent to parser-cmd (PID 3814):</b>
       [fruit]
       apple.color = "red"
       apple.taste.sweet = true

       [fruit.apple]  # INVALID
       # [fruit.apple.taste]  # INVALID

       [fruit.apple.texture]  # you can add sub-tables
       smooth = true

<b>     output from parser-cmd (PID 3814) (stdout):</b>
       {
         "fruit": {
           "apple": {
             "color": {"type": "string", "value": "red"},
             "taste": {
               "sweet": {"type": "bool", "value": "true"}
             },
             "texture": {
               "smooth": {"type": "bool", "value": "true"}
             }
           }
         }
       }

<b>     want:</b>
       Exit code 1

<b>FAIL</b> <b>invalid/spec-1.0.0/table-9-1</b>
<b> </b>    Expected an error, but no error was reported.

<b>     input sent to parser-cmd (PID 3813):</b>
       [fruit]
       apple.color = "red"
       apple.taste.sweet = true

       # [fruit.apple]  # INVALID
       [fruit.apple.taste]  # INVALID

       [fruit.apple.texture]  # you can add sub-tables
       smooth = true

<b>     output from parser-cmd (PID 3813) (stdout):</b>
       {
         "fruit": {
           "apple": {
             "color": {"type": "string", "value": "red"},
             "taste": {
               "sweet": {"type": "bool", "value": "true"}
             },
             "texture": {
               "smooth": {"type": "bool", "value": "true"}
             }
           }
         }
       }

<b>     want:</b>
       Exit code 1

<b>FAIL</b> <b>invalid/string/bad-uni-esc-03</b>
<b> </b>    Expected an error, but no error was reported.

<b>     input sent to parser-cmd (PID 3837):</b>
       bad-uni-esc-3 = "val\U0000000"

<b>     output from parser-cmd (PID 3837) (stdout):</b>
       {
         "bad-uni-esc-3": {"type": "string", "value": "val\u0000000"}
       }

<b>     want:</b>
       Exit code 1

<b>FAIL</b> <b>invalid/string/bad-uni-esc-04</b>
<b> </b>    Expected an error, but no error was reported.

<b>     input sent to parser-cmd (PID 3838):</b>
       bad-uni-esc-4 = "val\U0000"

<b>     output from parser-cmd (PID 3838) (stdout):</b>
       {
         "bad-uni-esc-4": {"type": "string", "value": "val\u0000"}
       }

<b>     want:</b>
       Exit code 1

<b>FAIL</b> <b>invalid/string/bad-uni-esc-3</b>
<b> </b>    Expected an error, but no error was reported.

<b>     input sent to parser-cmd (PID 3842):</b>
       bad-uni-esc-3 = "val\U0000000"

<b>     output from parser-cmd (PID 3842) (stdout):</b>
       {
         "bad-uni-esc-3": {"type": "string", "value": "val\u0000000"}
       }

<b>     want:</b>
       Exit code 1

<b>FAIL</b> <b>invalid/string/bad-uni-esc-4</b>
<b> </b>    Expected an error, but no error was reported.

<b>     input sent to parser-cmd (PID 3843):</b>
       bad-uni-esc-4 = "val\U0000"

<b>     output from parser-cmd (PID 3843) (stdout):</b>
       {
         "bad-uni-esc-4": {"type": "string", "value": "val\u0000"}
       }

<b>     want:</b>
       Exit code 1

<b>FAIL</b> <b>invalid/string/bad-uni-esc-ml-3</b>
<b> </b>    Expected an error, but no error was reported.

<b>     input sent to parser-cmd (PID 3851):</b>
       bad-uni-esc-ml-3 = """val\U0000000"""

<b>     output from parser-cmd (PID 3851) (stdout):</b>
       {
         "bad-uni-esc-ml-3": {"type": "string", "value": "val\u0000000"}
       }

<b>     want:</b>
       Exit code 1

<b>FAIL</b> <b>invalid/string/bad-uni-esc-ml-4</b>
<b> </b>    Expected an error, but no error was reported.

<b>     input sent to parser-cmd (PID 3853):</b>
       bad-uni-esc-ml-4 = """val\U0000"""

<b>     output from parser-cmd (PID 3853) (stdout):</b>
       {
         "bad-uni-esc-ml-4": {"type": "string", "value": "val\u0000"}
       }

<b>     want:</b>
       Exit code 1

<b>FAIL</b> <b>invalid/table/append-with-dotted-keys-01</b>
<b> </b>    Expected an error, but no error was reported.

<b>     input sent to parser-cmd (PID 3901):</b>
       # First a.b.c defines a table: a.b.c = {z=9}
       #
       # Then we define a.b.c.t = "str" to add a str to the above table, making it:
       #
       #   a.b.c = {z=9, t="..."}
       #
       # While this makes sense, logically, it was decided this is not valid TOML as
       # it's too confusing/convoluted.
       #
       # See: https://github.com/toml-lang/toml/issues/846
       #      https://github.com/toml-lang/toml/pull/859

       [a.b.c]
         z = 9

       [a]
         b.c.t = "Using dotted keys to add to [a.b.c] after explicitly defining it above is not allowed"

<b>     output from parser-cmd (PID 3901) (stdout):</b>
       {
         "a": {
           "b": {
             "c": {
               "z": {"type": "integer", "value": "9"},
               "t": {
                 "type":  "string",
                 "value": "Using dotted keys to add to [a.b.c] after explicitly defining it above is not allowed"
               }
             }
           }
         }
       }

<b>     want:</b>
       Exit code 1

<b>FAIL</b> <b>invalid/table/append-with-dotted-keys-02</b>
<b> </b>    Expected an error, but no error was reported.

<b>     input sent to parser-cmd (PID 3905):</b>
       # This is the same issue as in injection-1.toml, except that nests one level
       # deeper. See that file for a more complete description.

       [a.b.c.d]
         z = 9

       [a]
         b.c.d.k.t = "Using dotted keys to add to [a.b.c.d] after explicitly defining it above is not allowed"

<b>     output from parser-cmd (PID 3905) (stdout):</b>
       {
         "a": {
           "b": {
             "c": {
               "d": {
                 "z": {"type": "integer", "value": "9"},
                 "k": {
                   "t": {
                     "type":  "string",
                     "value": "Using dotted keys to add to [a.b.c.d] after explicitly defining it above is not allowed"
                   }
                 }
               }
             }
           }
         }
       }

<b>     want:</b>
       Exit code 1

<b>FAIL</b> <b>invalid/table/append-with-dotted-keys-03</b>
<b> </b>    Expected an error, but no error was reported.

<b>     input sent to parser-cmd (PID 3907):</b>
       [[a.b]]

       [a]
       b.y = 2

<b>     output from parser-cmd (PID 3907) (stdout):</b>
       {
         "a": {"b": [{
           "y": {"type": "integer", "value": "2"}
         }]}
       }

<b>     want:</b>
       Exit code 1

<b>FAIL</b> <b>invalid/table/append-with-dotted-keys-04</b>
<b> </b>    exit status 2

<b>     input sent to parser-cmd (PID 3908):</b>
       [dependencies.foo]
       version = "0.16"

       [dependencies]
       libc = "0.2"

       [dependencies]
       rand = "0.3.14"

<b>     output from parser-cmd (PID 3908) (stderr):</b>
       Fatal error: exception Otoml__Common.Duplicate_key("table [dependencies] is defined more than once")

<b>     want:</b>
       Exit code 1

<b>FAIL</b> <b>invalid/table/append-with-dotted-keys-05</b>
<b> </b>    exit status 2

<b>     input sent to parser-cmd (PID 3909):</b>
       a.b.c = 1
       a.b = 2

<b>     output from parser-cmd (PID 3909) (stderr):</b>
       Fatal error: exception Otoml__Common.Duplicate_key("duplicate key \"b\" overrides a value of type table with a value of type integer")

<b>     want:</b>
       Exit code 1

<b>FAIL</b> <b>invalid/table/append-with-dotted-keys-06</b>
<b> </b>    exit status 2

<b>     input sent to parser-cmd (PID 3910):</b>
       a = 1
       a.b = 2

<b>     output from parser-cmd (PID 3910) (stderr):</b>
       Fatal error: exception Otoml__Common.Duplicate_key("duplicate key \"a\" overrides a value of type integer with a value of type integer")

<b>     want:</b>
       Exit code 1

<b>FAIL</b> <b>invalid/table/append-with-dotted-keys-07</b>
<b> </b>    exit status 2

<b>     input sent to parser-cmd (PID 3911):</b>
       a = {k1 = 1, k1.name = "joe"}

<b>     output from parser-cmd (PID 3911) (stderr):</b>
       Fatal error: exception Otoml__Common.Duplicate_key("duplicate key \"k1\" overrides a value of type integer with a value of type string")

<b>     want:</b>
       Exit code 1

<b>FAIL</b> <b>invalid/table/duplicate-key-01</b>
<b> </b>    exit status 2

<b>     input sent to parser-cmd (PID 3922):</b>
       [a]
       b = 1

       [a]
       c = 2

<b>     output from parser-cmd (PID 3922) (stderr):</b>
       Fatal error: exception Otoml__Common.Duplicate_key("table [a] is defined more than once")

<b>     want:</b>
       Exit code 1

<b>FAIL</b> <b>invalid/table/duplicate-key-02</b>
<b> </b>    exit status 2

<b>     input sent to parser-cmd (PID 3924):</b>
       [fruit]
       type = "apple"

       [fruit.type]
       apple = "yes"

<b>     output from parser-cmd (PID 3924) (stderr):</b>
       Fatal error: exception Otoml__Common.Duplicate_key("table [fruit.type] is defined more than once")

<b>     want:</b>
       Exit code 1

<b>FAIL</b> <b>invalid/table/duplicate-key-03</b>
<b> </b>    Expected an error, but no error was reported.

<b>     input sent to parser-cmd (PID 3925):</b>
       [fruit]
       apple.color = "red"

       [[fruit.apple]]

<b>     output from parser-cmd (PID 3925) (stdout):</b>
       {
         "fruit": {
           "apple": {
             "color": {"type": "string", "value": "red"}
           }
         }
       }

<b>     want:</b>
       Exit code 1

<b>FAIL</b> <b>invalid/table/duplicate-key-04</b>
<b> </b>    Expected an error, but no error was reported.

<b>     input sent to parser-cmd (PID 3923):</b>
       [fruit]
       apple.color = "red"

       [fruit.apple] # INVALID

<b>     output from parser-cmd (PID 3923) (stdout):</b>
       {
         "fruit": {
           "apple": {
             "color": {"type": "string", "value": "red"}
           }
         }
       }

<b>     want:</b>
       Exit code 1

<b>FAIL</b> <b>invalid/table/duplicate-key-05</b>
<b> </b>    Expected an error, but no error was reported.

<b>     input sent to parser-cmd (PID 3926):</b>
       [fruit]
       apple.taste.sweet = true

       [fruit.apple.taste] # INVALID

<b>     output from parser-cmd (PID 3926) (stdout):</b>
       {
         "fruit": {
           "apple": {
             "taste": {
               "sweet": {"type": "bool", "value": "true"}
             }
           }
         }
       }

<b>     want:</b>
       Exit code 1

<b>FAIL</b> <b>invalid/table/duplicate-key-06</b>
<b> </b>    exit status 2

<b>     input sent to parser-cmd (PID 3927):</b>
       [tbl]
       [[tbl]]

<b>     output from parser-cmd (PID 3927) (stderr):</b>
       Fatal error: exception Otoml__Common.Duplicate_key("table [tbl] is duplicated by an array of tables [[tbl]]")

<b>     want:</b>
       Exit code 1

<b>FAIL</b> <b>invalid/table/duplicate-key-07</b>
<b> </b>    exit status 2

<b>     input sent to parser-cmd (PID 3929):</b>
       [[tbl]]
       [tbl]

<b>     output from parser-cmd (PID 3929) (stderr):</b>
       Fatal error: exception Otoml__Common.Duplicate_key("array of tables [[tbl]] is duplicated by a table [tbl]")

<b>     want:</b>
       Exit code 1

<b>FAIL</b> <b>invalid/table/duplicate-key-08</b>
<b> </b>    exit status 2

<b>     input sent to parser-cmd (PID 3930):</b>
       [a]
       b = { c = 2, d = {} }
       [a.b]
       c = 2

<b>     output from parser-cmd (PID 3930) (stderr):</b>
       Fatal error: exception Otoml__Common.Duplicate_key("table [a.b] is defined more than once")

<b>     want:</b>
       Exit code 1

<b>FAIL</b> <b>invalid/table/duplicate-key-09</b>
<b> </b>    exit status 2

<b>     input sent to parser-cmd (PID 3939):</b>
       [a]
       foo="bar"
       [a.b]
       foo="bar"
       [a]

<b>     output from parser-cmd (PID 3939) (stderr):</b>
       Fatal error: exception Otoml__Common.Duplicate_key("table [a] is defined more than once")

<b>     want:</b>
       Exit code 1

<b>FAIL</b> <b>invalid/table/duplicate-key-10</b>
<b> </b>    exit status 2

<b>     input sent to parser-cmd (PID 3928):</b>
       a = []
       [[a.b]]

<b>     output from parser-cmd (PID 3928) (stderr):</b>
       Fatal error: exception Otoml__Common.Duplicate_key("duplicate key \"a\" overrides a value of type array with a value of type array")

<b>     want:</b>
       Exit code 1

<b>FAIL</b> <b>invalid/table/overwrite-array-in-parent</b>
<b> </b>    exit status 2

<b>     input sent to parser-cmd (PID 3962):</b>
       [[parent-table.arr]]
       [parent-table]
       not-arr = 1
       arr = 2

<b>     output from parser-cmd (PID 3962) (stderr):</b>
       Fatal error: exception Otoml__Common.Duplicate_key("duplicate key \"arr\" overrides a value of type array with a value of type integer")

<b>     want:</b>
       Exit code 1

<b>FAIL</b> <b>invalid/table/overwrite-bool-with-array</b>
<b> </b>    exit status 2

<b>     input sent to parser-cmd (PID 3953):</b>
       a=true
       [[a]]

<b>     output from parser-cmd (PID 3953) (stderr):</b>
       Fatal error: exception Otoml__Common.Duplicate_key("table [a] is duplicated by an array of tables [[a]]")

<b>     want:</b>
       Exit code 1

<b>FAIL</b> <b>invalid/table/overwrite-with-deep-table</b>
<b> </b>    exit status 2

<b>     input sent to parser-cmd (PID 3955):</b>
       a=1
       [a.b.c.d]

<b>     output from parser-cmd (PID 3955) (stderr):</b>
       Fatal error: exception Otoml__Common.Duplicate_key("duplicate key \"a\" overrides a value of type integer with a value of type table")

<b>     want:</b>
       Exit code 1

<b>FAIL</b> <b>invalid/table/redefine-01</b>
<b> </b>    exit status 2

<b>     input sent to parser-cmd (PID 3952):</b>
       # Define b as int, and try to use it as a table: error
       [a]
       b = 1

       [a.b]
       c = 2

<b>     output from parser-cmd (PID 3952) (stderr):</b>
       Fatal error: exception Otoml__Common.Duplicate_key("table [a.b] is defined more than once")

<b>     want:</b>
       Exit code 1

<b>FAIL</b> <b>invalid/table/redefine-02</b>
<b> </b>    Expected an error, but no error was reported.

<b>     input sent to parser-cmd (PID 3957):</b>
       [t1]
       t2.t3.v = 0
       [t1.t2]

<b>     output from parser-cmd (PID 3957) (stdout):</b>
       {
         "t1": {
           "t2": {
             "t3": {
               "v": {"type": "integer", "value": "0"}
             }
           }
         }
       }

<b>     want:</b>
       Exit code 1

<b>FAIL</b> <b>invalid/table/redefine-03</b>
<b> </b>    Expected an error, but no error was reported.

<b>     input sent to parser-cmd (PID 3959):</b>
       [t1]
       t2.t3.v = 0
       [t1.t2.t3]

<b>     output from parser-cmd (PID 3959) (stdout):</b>
       {
         "t1": {
           "t2": {
             "t3": {
               "v": {"type": "integer", "value": "0"}
             }
           }
         }
       }

<b>     want:</b>
       Exit code 1

<b>FAIL</b> <b>invalid/table/super-twice</b>
<b> </b>    exit status 2

<b>     input sent to parser-cmd (PID 3960):</b>
       [a.b]
       [a]
       [a]

<b>     output from parser-cmd (PID 3960) (stderr):</b>
       Fatal error: exception Otoml__Common.Duplicate_key("table [a] is defined more than once")

<b>     want:</b>
       Exit code 1

toml-test v2025-04-23 [./decoder]: using embedded tests
  valid tests: 201 passed,  4 failed
invalid tests: 463 passed, 66 failed

==> ENCODER TESTS
<b>FAIL</b> <b>valid/float/max-int</b>
<b> </b>    Values for key "max_float" differ:
<b> </b>      Expected:     9.007199254740991e+15 (float64)
<b> </b>      Your encoder: 9007199254740991 (int64)

<b>     input sent to parser-cmd (PID 4040):</b>
       {
           "max_float": {"type": "float", "value": "9007199254740991"},
           "min_float": {"type": "float", "value": "-9007199254740991"}
       }

<b>     output from parser-cmd (PID 4040) (stdout):</b>
       max_float = 9007199254740991
       min_float = -9007199254740991

<b>     want:</b>
       # Maximum and minimum safe natural numbers.
       max_float =  9_007_199_254_740_991.0
       min_float = -9_007_199_254_740_991.0

<b>FAIL</b> <b>valid/float/zero</b>
<b> </b>    Values for key "exponent" differ:
<b> </b>      Expected:     0 (float64)
<b> </b>      Your encoder: 0 (int64)

<b>     input sent to parser-cmd (PID 4044):</b>
       {
           "exponent":            {"type": "float", "value": "0"},
           "exponent-signed-neg": {"type": "float", "value": "-0"},
           "exponent-signed-pos": {"type": "float", "value": "0"},
           "exponent-two-0":      {"type": "float", "value": "0"},
           "signed-neg":          {"type": "float", "value": "-0"},
           "signed-pos":          {"type": "float", "value": "0"},
           "zero":                {"type": "float", "value": "0"}
       }

<b>     output from parser-cmd (PID 4044) (stdout):</b>
       exponent = 0
       exponent-signed-neg = -0
       exponent-signed-pos = 0
       "exponent-two-0" = 0
       signed-neg = -0
       signed-pos = 0
       zero = 0

<b>     want:</b>
       zero = 0.0
       signed-pos = +0.0
       signed-neg = -0.0
       exponent = 0e0
       exponent-two-0 = 0e00
       exponent-signed-pos = +0e0
       exponent-signed-neg = -0e0

<b>FAIL</b> <b>valid/inline-table/key-dotted-5</b>
<b> </b>    Could not find key "arr-2" in encoder output

<b>     input sent to parser-cmd (PID 4061):</b>
       {
           "arr-1": [{
               "a": {
                   "b": {"type": "integer", "value": "1"}
               }
           }],
           "arr-2": [
               {"type": "string", "value": "str"},
               {
                   "a": {
                       "b": {"type": "integer", "value": "1"}
                   }
               }
           ],
           "arr-3": [
               {
                   "a": {
                       "b": {"type": "integer", "value": "1"}
                   }
               },
               {
                   "a": {
                       "b": {"type": "integer", "value": "2"}
                   }
               }
           ],
           "arr-4": [
               {"type": "string", "value": "str"},
               {
                   "a": {
                       "b": {"type": "integer", "value": "1"}
                   }
               },
               {
                   "a": {
                       "b": {"type": "integer", "value": "2"}
                   }
               }
           ]
       }

<b>     output from parser-cmd (PID 4061) (stdout):</b>
       [["arr-1"]]
         a = {b = 1}
       "arr-2" = ["str", {a = {b = 1}}]

       [["arr-3"]]
         a = {b = 1}

       [["arr-3"]]
         a = {b = 2}
       "arr-4" = ["str", {a = {b = 1}}, {a = {b = 2}}]

<b>     want:</b>
       arr-1 = [{a.b = 1}]
       arr-2 = ["str", {a.b = 1}]

       arr-3 = [{a.b = 1}, {a.b = 2}]
       arr-4 = ["str", {a.b = 1}, {a.b = 2}]

<b>FAIL</b> <b>valid/inline-table/key-dotted-7</b>
<b> </b>    exit status 2

<b>     input sent to parser-cmd (PID 4064):</b>
       {
           "arr": [{
               "a": {"b": [{
                   "c": {
                       "d": {"type": "integer", "value": "1"}
                   }
               }]}
           }]
       }

<b>     output from parser-cmd (PID 4064) (stderr):</b>
       Fatal error: exception Failure("TOML arrays of tables cannot be formatted out of the parent table context")

<b>     want:</b>
          <empty>

<b>FAIL</b> <b>valid/inline-table/spaces</b>
<b> </b>    Values for key "clap-2.nest.b" differ:
<b> </b>      Expected:     9 (float64)
<b> </b>      Your encoder: 9 (int64)

<b>     input sent to parser-cmd (PID 4062):</b>
       {
           "clap-1": {
               "version": {"type": "string", "value": "4"},
               "features": [
                   {"type": "string", "value": "derive"},
                   {"type": "string", "value": "cargo"}
               ]
           },
           "clap-2": {
               "version": {"type": "string", "value": "4"},
               "features": [
                   {"type": "string", "value": "derive"},
                   {"type": "string", "value": "cargo"}
               ],
               "nest": {
                   "a": {"type": "string", "value": "x"},
                   "b": [
                       {"type": "float", "value": "1.5"},
                       {"type": "float", "value": "9"}
                   ]
               }
           }
       }

<b>     output from parser-cmd (PID 4062) (stdout):</b>
       ["clap-1"]
         version = "4"
         features = ["derive", "cargo"]

       ["clap-2"]
         version = "4"
         features = ["derive", "cargo"]

       ["clap-2".nest]
         a = "x"
         b = [1.5, 9]

<b>     want:</b>
       # https://github.com/toml-lang/toml-test/issues/146
       clap-1 = { version = "4"  , features = ["derive", "cargo"] }

       # Contains some literal tabs!
       clap-2 = { version = "4"	   	,	  	features = [   "derive" 	  ,  	  "cargo"   ]   , nest   =   {  	  "a"   =   'x'  , 	  'b'   = [ 1.5    ,   9.0  ]  }  }

<b>FAIL</b> <b>valid/spec-1.0.0/array-of-tables-1</b>
<b> </b>    Could not find key "fruits.physical" in encoder output

<b>     input sent to parser-cmd (PID 4112):</b>
       {
           "fruits": [
               {
                   "name": {"type": "string", "value": "apple"},
                   "physical": {
                       "color": {"type": "string", "value": "red"},
                       "shape": {"type": "string", "value": "round"}
                   },
                   "varieties": [
                       {
                           "name": {"type": "string", "value": "red delicious"}
                       },
                       {
                           "name": {"type": "string", "value": "granny smith"}
                       }
                   ]
               },
               {
                   "name":      {"type": "string", "value": "banana"},
                   "varieties": [{
                       "name": {"type": "string", "value": "plantain"}
                   }]
               }
           ]
       }

<b>     output from parser-cmd (PID 4112) (stdout):</b>
       [[fruits]]
         name = "apple"

       [[fruits.varieties]]
         name = "red delicious"

       [[fruits.varieties]]
         name = "granny smith"
         physical = {color = "red", shape = "round"}

       [[fruits]]
         name = "banana"

       [[fruits.varieties]]
         name = "plantain"

<b>     want:</b>
       [[fruits]]
       name = "apple"

       [fruits.physical]  # subtable
       color = "red"
       shape = "round"

       [[fruits.varieties]]  # nested array of tables
       name = "red delicious"

       [[fruits.varieties]]
       name = "granny smith"


       [[fruits]]
       name = "banana"

       [[fruits.varieties]]
       name = "plantain"

<b>FAIL</b> <b>valid/spec-1.0.0/float-0</b>
<b> </b>    Values for key "flt1" differ:
<b> </b>      Expected:     1 (float64)
<b> </b>      Your encoder: 1 (int64)

<b>     input sent to parser-cmd (PID 4116):</b>
       {
           "flt1": {"type": "float", "value": "1"},
           "flt2": {"type": "float", "value": "3.1415"},
           "flt3": {"type": "float", "value": "-0.01"},
           "flt4": {"type": "float", "value": "5e+22"},
           "flt5": {"type": "float", "value": "1e+06"},
           "flt6": {"type": "float", "value": "-0.02"},
           "flt7": {"type": "float", "value": "6.626e-34"}
       }

<b>     output from parser-cmd (PID 4116) (stdout):</b>
       "flt1" = 1
       "flt2" = 3.1415
       "flt3" = -0.01
       "flt4" = 5e+22
       "flt5" = 1e+6
       "flt6" = -0.02
       "flt7" = 6.626e-34

<b>     want:</b>
       # fractional
       flt1 = +1.0
       flt2 = 3.1415
       flt3 = -0.01

       # exponent
       flt4 = 5e+22
       flt5 = 1e06
       flt6 = -2E-2

       # both
       flt7 = 6.626e-34

<b>FAIL</b> <b>valid/table/array-implicit-and-explicit-after</b>
<b> </b>    Could not find key "a.y" in encoder output

<b>     input sent to parser-cmd (PID 4190):</b>
       {
           "a": {
               "b": [{
                   "x": {"type": "integer", "value": "1"}
               }],
               "y": {"type": "integer", "value": "2"}
           }
       }

<b>     output from parser-cmd (PID 4190) (stdout):</b>
       [a]

       [[a.b]]
         x = 1
         y = 2

<b>     want:</b>
       [[a.b]]
       x = 1

       [a]
       y = 2

toml-test v2025-04-23 [./encoder]: using embedded tests
encoder tests: 197 passed,  8 failed
took 0.0 0.0
</pre>
